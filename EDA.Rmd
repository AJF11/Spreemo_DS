---
title: "Exploratory Data Analysis"
output: html_notebook
---

```{r setup, echo=FALSE, message=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	message = TRUE,
	warning = TRUE
)
dataPath <- file.path(dirname(getwd()), 'data')
```

```{r, message = FALSE}
library(tidyverse)
library(stringr)
library(lubridate)
library(scales)
```

```{r read in data, message = FALSE}
exam_data <- read_csv(file.path(dataPath, 'ExamRatingData072516.csv'))
equipment_data <- read_csv(file.path(dataPath, 'ProviderEquipmentData072516.csv'))
subspecial_data <- read_csv(file.path(dataPath, 'ProviderSubspecializationData072516.csv'))
```

```{r, include=FALSE, eval = FALSE}
names(exam_data)
names(equipment_data)
names(subspecial_data)
```

Let's start by taking a quick glance at the exam data file.

```{r}
head(exam_data, 10)
```

So we can see that the first column is an Exam ID, the second column is a Provider IS.  We can see that there are sometimes multiple Reviewer IDs for one exam.  We can also see that there are a number of missing variables.

```{r}
exam_data %>%
  select(c(4:5, 7:12)) %>%
  is.na %>%
  colMeans
```

Certain variables -- such as the scores -- are complete, while other ones are missing more than 50% of the information. 

I also wanted to see how many claims have multiple reviews.

```{r}
exam_data %>%
  count(Exam.ID, Provider.ID) %>%
  ungroup %>%
  count(n) %>%
  mutate(pct = percent(nn/ sum(nn)))
```

While most Exam IDs have only one reviewer, 16.5% have two, and none have more than two.

I want to look at the claims with multiple ratings.

```{r}
exam_data %>%
  count(Exam.ID, Provider.ID) %>%
  filter(n >1) %>%
  semi_join(exam_data, ., by = c("Exam.ID", "Provider.ID")) %>%
  select(c(1:3,13:16)) %>%
  group_by(Exam.ID, Provider.ID) %>%
  summarize_all(n_distinct) %>%
  ungroup %>%
  select(-(1:2)) %>%
  colSums
```

```{r}
summaries1 <- exam_data %>%
  group_by(Exam.ID, Provider.ID) %>%
  summarise_at(c(4:5, 7:12), mean, na.rm = T) %>%
  mutate_all(na_if, y= 'NaN')
```

```{r}
describ_data <- exam_data %>%
  distinct(Exam.ID, Provider.ID, .keep_all = TRUE)
```

